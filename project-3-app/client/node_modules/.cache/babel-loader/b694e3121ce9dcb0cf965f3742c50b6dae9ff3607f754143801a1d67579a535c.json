{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Daniel/bootcamp/project-3/project-3-app/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Daniel/bootcamp/project-3/project-3-app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"C:/Users/Daniel/bootcamp/project-3/project-3-app/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"C:/Users/Daniel/bootcamp/project-3/project-3-app/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/Daniel/bootcamp/project-3/project-3-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import Form from\"react-bootstrap/Form\";import Button from'react-bootstrap/Button';import{useMutation}from\"@apollo/client\";// import { useParams } from \"react-router-dom\";\nimport Auth from'../utils/auth';import{ADD_POST}from\"../utils/mutations\";import{QUERY_POSTS,QUERY_ME}from'../utils/queries';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PostForm=function PostForm(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),postText=_useState2[0],setPostText=_useState2[1];// const [characterCount, setCharacterCount] = useState(0);\nvar _useMutation=useMutation(ADD_POST,{update:function update(cache,_ref){var addPost=_ref.data.addPost;try{var _cache$readQuery=cache.readQuery({query:QUERY_POSTS}),posts=_cache$readQuery.posts;cache.writeQuery({query:QUERY_POSTS,data:{posts:[addPost].concat(_toConsumableArray(posts))}});}catch(e){console.error(e);}var _cache$readQuery2=cache.readQuery({query:QUERY_ME}),me=_cache$readQuery2.me;cache.writeQuery({query:QUERY_ME,data:{me:_objectSpread(_objectSpread({},me),{},{posts:[].concat(_toConsumableArray(me.posts),[addPost])})}});}}),_useMutation2=_slicedToArray(_useMutation,2),addPost=_useMutation2[0],error=_useMutation2[1].error;var handleFormSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var _yield$addPost,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();_context.prev=1;_context.next=4;return addPost({variables:{postText:postText,postAuthor:Auth.getProfile().data.username}});case 4:_yield$addPost=_context.sent;data=_yield$addPost.data;setPostText('');_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);console.error(_context.t0);case 12:case\"end\":return _context.stop();}},_callee,null,[[1,9]]);}));return function handleFormSubmit(_x){return _ref2.apply(this,arguments);};}();var handleChange=function handleChange(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;if(name==='postText'&&value.length<=280){setPostText(value);// setCharacterCount(value.length)\n}};// const { postId } = useParams();\n// const { loading, data } = useMutation(ADD_POST, {\n//   // pass URL parameter\n//   variables: { postId: postId },\n// });\n// const post = data?.post || {};\n// if (loading) {\n//   return <div>Loading...</div>;\n// }\nreturn/*#__PURE__*/_jsxs(Form,{onSubmit:handleFormSubmit,children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"exampleForm.ControlTextarea1\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Post Here\"}),/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",onChange:handleChange,rows:3})]}),/*#__PURE__*/_jsx(Button,{as:\"input\",type:\"submit\",value:\"Submit\"}),' ']});};export default PostForm;","map":{"version":3,"names":["React","useState","Form","Button","useMutation","Auth","ADD_POST","QUERY_POSTS","QUERY_ME","jsx","_jsx","jsxs","_jsxs","PostForm","_useState","_useState2","_slicedToArray","postText","setPostText","_useMutation","update","cache","_ref","addPost","data","_cache$readQuery","readQuery","query","posts","writeQuery","concat","_toConsumableArray","e","console","error","_cache$readQuery2","me","_objectSpread","_useMutation2","handleFormSubmit","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","_yield$addPost","wrap","_callee$","_context","prev","next","preventDefault","variables","postAuthor","getProfile","username","sent","t0","stop","_x","apply","arguments","handleChange","_event$target","target","name","value","length","onSubmit","children","Group","className","controlId","Label","Control","as","onChange","rows","type"],"sources":["C:/Users/Daniel/bootcamp/project-3/project-3-app/client/src/components/pages/PostForm.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport Form from \"react-bootstrap/Form\";\nimport Button from 'react-bootstrap/Button';\nimport { useMutation } from \"@apollo/client\";\n// import { useParams } from \"react-router-dom\";\nimport Auth from '../utils/auth';\nimport { ADD_POST } from \"../utils/mutations\";\nimport { QUERY_POSTS, QUERY_ME } from '../utils/queries';\n\nconst PostForm = () => {\n  const [postText, setPostText] = useState('');\n\n  // const [characterCount, setCharacterCount] = useState(0);\n\n  const [addPost, { error }] = useMutation(ADD_POST, {\n    update( cache, { data: { addPost } }) {\n      try {\n        const { posts } = cache.readQuery({ query: QUERY_POSTS });\n\n        cache.writeQuery({\n          query: QUERY_POSTS,\n          data: { posts: [ addPost, ...posts] },\n        });\n      } catch (e) {\n        console.error(e)\n      }\n\n      const { me } = cache.readQuery({ query: QUERY_ME });\n      cache.writeQuery({\n        query: QUERY_ME,\n        data: { me: { ...me, posts: [...me.posts, addPost] } },\n      });\n    },\n  });\n\n  const handleFormSubmit = async (event) => {\n    event.preventDefault();\n\n    try {\n      const { data } = await addPost({\n        variables: {\n          postText,\n          postAuthor: Auth.getProfile().data.username,\n        },\n      });\n\n      setPostText('')\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  const handleChange = (event) => {\n    const { name, value } = event.target;\n    \n    if (name === 'postText' && value.length <= 280) {\n      setPostText(value);\n      // setCharacterCount(value.length)\n    }\n  }\n  // const { postId } = useParams();\n\n  // const { loading, data } = useMutation(ADD_POST, {\n  //   // pass URL parameter\n  //   variables: { postId: postId },\n  // });\n\n  // const post = data?.post || {};\n\n  // if (loading) {\n  //   return <div>Loading...</div>;\n  // }\n  return (\n    <Form onSubmit={handleFormSubmit}>\n      <Form.Group className=\"mb-3\" controlId=\"exampleForm.ControlTextarea1\">\n        <Form.Label>Post Here</Form.Label>\n        <Form.Control as=\"textarea\" onChange={handleChange} rows={3} />\n      </Form.Group>\n      <Button as=\"input\" type=\"submit\" value=\"Submit\" />{' '}\n    </Form>\n  );\n}\n\nexport default PostForm;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}